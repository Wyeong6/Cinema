<!DOCTYPE html>
<html lang="en" layout:decorate="~{layout/layout_total}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Cinemacast</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/assets/css/main.css" />
    <link rel="stylesheet" href="/assets/css/custom.css" />
    <link rel="stylesheet" href="/assets/css/custom_player.css" />
    <link rel="stylesheet" href="/assets/css/nav.css" />
    <noscript><link rel="stylesheet" href="/assets/css/noscript.css" /></noscript>
</head>
<body class="right-sidebar is-preload">
<th:block layout:fragment="content">
    <div id="page-wrapper">

        <!-- 메인 -->
        <div class="wrapper style1 screening-schedule">
            <div class="container">
                <article id="main" class="special">
                    <header>
                        <h2>상영시간표</h2>
                    </header>
                    <hr />
                    <div class="row">
                        <table id="theaterTable" class="default">
                            <thead>
                            <tr>
                                <th id="select-theater-th" colspan="2">영화관 선택</th>
                                <th id="select-movie-th">영화 선택</th>
                                <th id="select-time-th">시간 선택</th>
                            </tr>
                            </thead>
                            <tbody id="theaterGroup">
                            <tr>
                                <td id="select-theater-group">
                                    <div id="select-region">
                                        <ul>
                                            <li class="region-btn">
                                                <a>서울</a>
                                                <input type="hidden" value="Seo" class="region-value"/>
                                            </li>
                                            <li class="region-btn">
                                                <a>인천 / 경기</a>
                                                <input type="hidden" value="Inc" class="region-value"/>
                                            </li>
                                            <li class="region-btn">
                                                <a>강원</a>
                                                <input type="hidden" value="Gan" class="region-value"/>
                                            </li>
                                            <li class="region-btn">
                                                <a>대전 / 충청</a>
                                                <input type="hidden" value="Chu" class="region-value"/>
                                            </li>
                                            <li class="region-btn">
                                                <a>대구 / 경북</a>
                                                <input type="hidden" value="Dae" class="region-value"/>
                                            </li>
                                            <li class="region-btn">
                                                <a>부산 / 울산 / 경남</a>
                                                <input type="hidden" value="Bus" class="region-value"/>
                                            </li>
                                            <li class="region-btn">
                                                <a>광주 / 전라</a>
                                                <input type="hidden" value="Gwa" class="region-value" />
                                            </li>
                                            <li class="region-btn">
                                                <a>제주</a>
                                                <input type="hidden" value="Jeju" class="region-value" />
                                            </li>
                                        </ul>
                                    </div>
                                </td>
                                <td id="theaterList">
                                    <table>
                                        <tbody></tbody>
                                    </table>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </article>
            </div>

        </div>
    </div>

    <!-- 스크립트 -->
    <script src="/assets/js/jquery.min.js"></script>

    <script>
        $(document).ready(function(){
            $(".region-btn").click(function(event){
                event.preventDefault();
                $(".region-btn.clicked").removeClass("clicked");
                $(this).addClass('clicked');
                const regionValue = $(this).find('.region-value').val();
                $.ajax({
                    type: "GET",
                    url: "/reservation/getTheatersByRegion",
                    data: {
                        region: regionValue
                    },
                    success: function(data) {
                        const $tbody = $("#theaterList tbody");
                        $tbody.empty();
                        if(data.length > 0) {
                            $.each(data, function(index, theater) {
                                const $tr = $("<tr class='theater-row'></tr>");
                                const $td = $("<td></td>").text(theater.theaterName);
                                $tr.append($td);
                                $tbody.append($tr);
                            });
                        } else {
                            const $tr = $("<tr class='theater-row'></tr>");
                            const $td = $("<td></td>").text("해당 지역에 영화관이 없습니다.");
                            $tr.append($td);
                            $tbody.append($tr);
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error("AJAX 요청 실패:", error); // 오류 메시지 출력
                    }
                });
            });
        });
    </script>

    <script src="/assets/js/jquery.dropotron.min.js"></script>
    <script src="/assets/js/jquery.scrolly.min.js"></script>
    <script src="/assets/js/jquery.scrollex.min.js"></script>
    <script src="/assets/js/browser.min.js"></script>
    <script src="/assets/js/breakpoints.min.js"></script>
    <script src="/assets/js/util.js"></script>
    <script src="/assets/js/main.js"></script>


</th:block>
</body>
</html>
